#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <stdbool.h>
#include <float.h>

// ================== Conv1d: conv1d_1 ================== //
// Weight for conv1d: 5x3x3 @out_channels x in_channels x kernel_size;
float conv1d_1_weights[45] = {0.16088867, 0.02774048, -0.14550781, 0.05178833, 0.12408447, -0.30761719, -0.00164223, -0.14294434, 0.26367188, -0.27758789, 0.07128906, -0.22302246, -0.07269287, -0.21606445, -0.01818848, -0.21826172, 0.06341553, -0.11517334, -0.01988220, 0.07153320, -0.07867432, -0.31958008, 0.11718750, 0.28320312, 0.32446289, -0.15405273, -0.18603516, 0.26074219, 0.11578369, 0.29614258, 0.01233673, -0.02232361, 0.24926758, -0.03680420, -0.23242188, 0.13671875, -0.11859131, -0.18908691, 0.29736328, 0.04129028, 0.20446777, 0.25024414, -0.18505859, 0.24975586, -0.05923462};
// Bias for conv1d: 5 @out_channels;
float conv1d_1_bias[5] = {0.30273438, -0.17041016, 0.21215820, 0.02621460, 0.31445312};

// ================== Conv1d: conv1d_2 ================== //
// Weight for conv1d: 10x5x3 @out_channels x in_channels x kernel_size;
float conv1d_2_weights[150] = {0.20227051, -0.00399399, 0.13928223, -0.07208252, 0.13793945, -0.09930420, 0.07287598, -0.11212158, -0.24426270, 0.12377930, 0.25537109, 0.13073730, -0.02745056, 0.16125488, 0.13305664, 0.02003479, 0.11474609, 0.16625977, 0.10937500, -0.20617676, 0.12023926, -0.10003662, 0.21252441, 0.17346191, -0.03347778, -0.10229492, -0.05487061, -0.08709717, -0.19348145, 0.07031250, -0.22607422, 0.13171387, 0.21252441, -0.09228516, 0.15063477, 0.10559082, 0.02851868, 0.04895020, 0.07977295, -0.01579285, 0.16247559, 0.12048340, 0.02403259, -0.13940430, 0.12292480, -0.03744507, -0.19604492, 0.13586426, 0.19750977, 0.11169434, 0.10589600, 0.02624512, 0.20068359, -0.00868988, 0.04602051, 0.12780762, 0.05044556, -0.00862122, 0.09161377, 0.01869202, -0.11608887, 0.11682129, 0.00884247, -0.05410767, -0.01062775, 0.04953003, -0.17907715, -0.24475098, 0.20666504, -0.10748291, 0.04309082, 0.19262695, -0.06347656, 0.09100342, -0.22448730, 0.16271973, -0.08074951, -0.15209961, -0.04037476, -0.04452515, 0.07415771, 0.25781250, 0.04824829, 0.04434204, 0.16418457, 0.03506470, 0.07885742, -0.03210449, -0.22424316, 0.14428711, -0.17797852, 0.17614746, 0.20458984, 0.07983398, 0.23669434, -0.05792236, 0.15515137, -0.12231445, -0.10955811, 0.24816895, 0.14184570, -0.15405273, 0.13562012, -0.04238892, -0.24719238, 0.11798096, 0.15722656, -0.12347412, -0.11114502, 0.10693359, -0.02542114, 0.18554688, 0.17407227, 0.22387695, -0.03463745, 0.18542480, 0.22863770, -0.19226074, -0.11224365, -0.19873047, 0.22668457, 0.14013672, -0.23327637, -0.16467285, 0.24890137, 0.22436523, 0.24475098, -0.18273926, 0.21606445, -0.24401855, 0.24719238, -0.23583984, 0.21972656, 0.16235352, 0.03344727, -0.02265930, -0.06054688, -0.05627441, -0.03582764, -0.17260742, -0.13549805, -0.01142120, -0.15661621, -0.03213501, 0.12707520, -0.22229004, 0.14843750, -0.08013916, -0.25390625, 0.16076660};
// Bias for conv1d: 10 @out_channels;
float conv1d_2_bias[10] = {-0.16198730, 0.10870361, -0.04837036, -0.23425293, 0.13134766, 0.23913574, 0.07116699, -0.24096680, -0.24511719, -0.25708008};

// ================== Flatten: fl1 ================== //
// Flatten for layer: fl1;

// ================== Layer: fc1 ================== //
// Transposed weights for layer: fc1 @60x32;
float fc1_weight_transposed[1920] = {0.06372070, -0.08868408, -0.10974121, -0.04107666, 0.03924561, 0.00291824, -0.00308037, 0.02720642, 0.04904175, 0.08355713, -0.07885742, 0.05596924, 0.02026367, 0.11230469, -0.09777832, -0.05349731, 0.06335449, -0.11633301, 0.03378296, 0.11743164, 0.02821350, 0.00048614, -0.05224609, -0.02767944, 0.11047363, -0.11737061, -0.09466553, -0.03878784, 0.01164246, -0.05807495, -0.00379181, -0.04376221, 0.07476807, -0.03253174, 0.01397705, -0.02098083, -0.00249672, 0.07879639, -0.08996582, 0.00174999, -0.04339600, -0.04248047, -0.12402344, -0.04690552, -0.03120422, -0.05642700, -0.07098389, -0.02241516, -0.11767578, 0.06988525, 0.01104736, -0.07153320, 0.05831909, 0.12536621, 0.06048584, 0.10491943, 0.02200317, -0.08685303, 0.12609863, -0.10833740, 0.03671265, 0.04336548, -0.11804199, -0.09259033, -0.00388145, 0.04434204, 0.05639648, 0.12841797, 0.08374023, -0.07989502, -0.05145264, 0.06378174, -0.02285767, 0.07800293, -0.04119873, 0.10552979, -0.11669922, -0.01805115, -0.03976440, -0.06274414, -0.06060791, 0.11175537, 0.10375977, 0.06475830, -0.06198120, 0.04330444, 0.10357666, -0.06530762, -0.08697510, 0.03500366, 0.00796509, -0.06185913, 0.06048584, 0.09814453, -0.03048706, 0.05838013, -0.01567078, 0.05130005, 0.00883484, 0.08770752, 0.11322021, -0.06097412, 0.11212158, 0.06860352, -0.04928589, 0.04574585, 0.01416016, 0.09899902, 0.09362793, -0.03137207, 0.09295654, -0.03796387, -0.08929443, -0.11608887, 0.00531387, -0.07012939, -0.07751465, 0.01412964, -0.08917236, 0.06622314, 0.03530884, -0.10253906, -0.10998535, 0.09783936, 0.11535645, 0.01049042, -0.12548828, 0.07452393, -0.07653809, -0.00065565, 0.05975342, 0.09423828, 0.00942230, 0.04574585, -0.09252930, -0.08850098, -0.04757690, 0.07916260, -0.10064697, 0.08990479, 0.11865234, 0.08587646, 0.06402588, 0.01490784, -0.05581665, -0.08789062, 0.05584717, -0.04409790, 0.11907959, -0.01107025, 0.02777100, 0.01016998, -0.01649475, 0.02210999, -0.08789062, -0.07647705, 0.08300781, -0.02632141, 0.01853943, 0.09307861, 0.04809570, -0.12322998, 0.02978516, 0.11273193, -0.05041504, -0.03521729, 0.09356689, -0.06872559, -0.04922485, 0.09472656, 0.02697754, 0.03060913, 0.00424576, -0.07580566, -0.00542831, -0.10961914, -0.12573242, 0.07092285, -0.05233765, 0.01234436, 0.00105858, 0.06240845, 0.11175537, -0.10821533, 0.01340485, -0.02342224, 0.00461960, 0.09271240, 0.08599854, 0.07092285, -0.05245972, 0.06646729, 0.12066650, 0.06634521, 0.08776855, 0.09094238, 0.02737427, -0.02606201, -0.06094360, 0.08276367, -0.12878418, -0.08325195, -0.08026123, -0.12347412, 0.00495529, 0.01543427, 0.05923462, 0.01284027, -0.03909302, 0.03399658, -0.01478577, 0.03094482, -0.05108643, -0.07751465, 0.12524414, 0.03710938, 0.10864258, -0.08044434, 0.04736328, 0.10333252, 0.04849243, -0.07000732, -0.00848389, -0.02165222, 0.02508545, 0.11822510, 0.10296631, 0.06774902, 0.12634277, -0.08276367, 0.09716797, 0.00560760, 0.09466553, -0.09741211, 0.09881592, 0.09832764, -0.09539795, 0.10443115, -0.12457275, 0.00159931, 0.10290527, -0.08221436, -0.02336121, -0.10577393, 0.04235840, -0.01000977, 0.11804199, 0.04382324, -0.10925293, -0.07653809, 0.08032227, 0.04241943, -0.10375977, -0.01479340, 0.11938477, 0.08374023, -0.01225281, 0.07452393, 0.12890625, 0.02067566, -0.06048584, 0.00398636, 0.10638428, 0.00936890, -0.10559082, 0.05722046, 0.12756348, 0.08831787, -0.07312012, -0.08575439, 0.03189087, 0.06304932, 0.12182617, -0.07672119, -0.09100342, 0.08117676, -0.11865234, 0.06964111, 0.06384277, 0.00569153, 0.01876831, 0.08325195, 0.08343506, 0.02458191, 0.06402588, -0.08276367, -0.09326172, 0.06057739, 0.09918213, -0.08477783, 0.04147339, -0.03244019, 0.11761475, 0.10607910, -0.09277344, -0.09246826, -0.04364014, 0.06506348, 0.07135010, -0.08123779, -0.06536865, 0.05453491, -0.06384277, -0.02717590, 0.04821777, -0.06732178, -0.11431885, 0.02185059, 0.03067017, -0.11785889, -0.07098389, 0.12347412, 0.09130859, 0.01596069, 0.11108398, -0.00465775, -0.03204346, 0.05670166, 0.00846863, -0.08288574, -0.08135986, -0.06018066, -0.04714966, -0.11761475, -0.05874634, -0.10034180, 0.11077881, 0.06192017, -0.01101685, 0.11395264, -0.11785889, -0.01722717, -0.01323700, 0.12457275, -0.09118652, 0.06866455, 0.04708862, -0.00072098, -0.02908325, -0.01314545, -0.09777832, 0.11212158, 0.07379150, -0.06088257, 0.09912109, 0.10632324, 0.06433105, 0.08923340, -0.06427002, -0.12585449, 0.04946899, 0.06542969, 0.01638794, -0.03631592, 0.08978271, -0.11010742, 0.06378174, -0.05456543, 0.10992432, 0.08618164, 0.05398560, -0.08435059, -0.05725098, -0.11315918, -0.09246826, -0.01493073, 0.00850677, -0.12695312, 0.05740356, -0.09674072, 0.02343750, -0.11926270, 0.06579590, 0.02137756, 0.05123901, -0.11791992, -0.06359863, -0.05123901, -0.12042236, 0.08819580, 0.09631348, 0.07525635, -0.10827637, 0.05072021, -0.08447266, 0.05514526, -0.09246826, 0.09979248, 0.01774597, -0.01558685, -0.11077881, 0.12780762, -0.01628113, 0.04858398, -0.09130859, -0.01412964, -0.11010742, -0.00865936, 0.11029053, 0.04724121, -0.01002502, -0.02261353, -0.09667969, -0.03570557, 0.07806396, 0.03601074, -0.04690552, -0.06518555, -0.01358795, -0.02001953, 0.03640747, 0.05239868, -0.10961914, 0.12780762, -0.07995605, 0.07232666, 0.12780762, 0.08148193, -0.07873535, 0.05773926, 0.10229492, -0.12438965, 0.05282593, 0.06512451, -0.03158569, 0.09857178, -0.12188721, -0.12731934, -0.07269287, 0.03277588, 0.09753418, 0.01020813, -0.12292480, -0.11260986, 0.07781982, -0.05023193, 0.01040649, -0.11279297, -0.10772705, 0.01216125, -0.10693359, 0.09490967, -0.10974121, -0.07391357, -0.03131104, 0.08612061, 0.06982422, -0.10650635, 0.04943848, 0.04107666, -0.11920166, 0.03836060, -0.05517578, 0.06561279, 0.05615234, -0.12902832, 0.03543091, 0.06945801, 0.07012939, -0.12536621, -0.05892944, -0.10913086, 0.12402344, 0.08880615, -0.09912109, 0.06286621, -0.09783936, 0.07562256, 0.02978516, -0.01910400, -0.05447388, 0.08605957, 0.10205078, -0.05545044, 0.02821350, -0.00717545, -0.00031209, -0.11059570, -0.00112247, 0.05346680, 0.06652832, 0.11798096, 0.02348328, 0.02819824, -0.03326416, 0.12561035, 0.10919189, 0.02728271, 0.03494263, 0.03982544, 0.00623322, -0.06884766, -0.00253487, -0.04132080, 0.09100342, -0.06204224, 0.03387451, 0.05111694, -0.08660889, 0.07781982, 0.05044556, -0.09490967, 0.01411438, -0.04489136, 0.06713867, -0.02493286, 0.09136963, 0.02882385, 0.05307007, 0.07684326, 0.08496094, -0.04818726, 0.07568359, -0.01172638, -0.10418701, -0.11218262, 0.01741028, 0.06451416, 0.06817627, 0.04598999, -0.02716064, 0.04034424, -0.12341309, -0.06176758, 0.10095215, -0.07775879, 0.02429199, -0.12878418, -0.02137756, 0.09814453, 0.06039429, -0.09735107, -0.12280273, 0.03802490, 0.10723877, -0.12854004, 0.10461426, 0.04833984, 0.08551025, 0.11920166, 0.04934692, -0.07348633, 0.11224365, -0.04190063, -0.06390381, 0.12500000, -0.07189941, -0.01130676, -0.07391357, -0.05654907, 0.02201843, 0.03839111, -0.07867432, -0.02490234, -0.10302734, 0.10253906, -0.02612305, -0.04290771, -0.05529785, -0.05358887, 0.04376221, -0.05398560, 0.11334229, -0.01537323, 0.10180664, -0.00875092, -0.03041077, -0.10943604, 0.12744141, 0.11157227, 0.03634644, -0.06008911, -0.06884766, 0.04641724, 0.04754639, 0.01048279, 0.08831787, 0.01763916, 0.09594727, 0.11450195, -0.06210327, 0.05224609, 0.10162354, 0.12377930, 0.11315918, 0.12243652, -0.07208252, 0.11926270, 0.01512146, -0.11596680, -0.06646729, 0.12792969, -0.08282471, -0.04641724, 0.01972961, -0.11071777, 0.02252197, 0.09588623, 0.06268311, 0.08056641, -0.05117798, -0.09655762, 0.12420654, -0.12371826, 0.06707764, 0.01724243, -0.02124023, 0.11853027, -0.09606934, 0.07470703, -0.06768799, 0.03448486, -0.09259033, 0.03784180, -0.03604126, -0.02491760, -0.09320068, 0.12756348, 0.03521729, 0.08306885, -0.05563354, -0.06567383, 0.06311035, -0.01008606, 0.09753418, -0.01093292, -0.12261963, -0.00883484, -0.06225586, 0.09765625, 0.00239372, -0.06469727, 0.09844971, -0.07342529, 0.00102234, -0.12719727, 0.10638428, -0.10156250, -0.01211548, -0.11541748, 0.11511230, -0.10156250, -0.04556274, 0.03991699, 0.05249023, -0.09686279, -0.11816406, -0.04406738, 0.02600098, -0.03216553, 0.06494141, -0.05355835, -0.04699707, 0.02383423, 0.10217285, -0.03585815, 0.07910156, -0.05551147, -0.04937744, 0.09027100, 0.05374146, 0.09118652, -0.06597900, 0.04687500, -0.12524414, 0.06274414, 0.00501633, -0.05126953, 0.04321289, 0.05023193, -0.02723694, 0.08441162, -0.09722900, -0.06372070, 0.05526733, 0.11511230, 0.11157227, 0.03912354, 0.03048706, -0.04956055, 0.02174377, -0.06060791, -0.12188721, 0.08032227, 0.05090332, 0.01986694, 0.08166504, 0.01457214, -0.01204681, 0.07641602, 0.02754211, 0.06130981, -0.12219238, 0.10504150, 0.11517334, 0.08276367, 0.11883545, -0.11108398, 0.12481689, -0.10076904, 0.12536621, 0.00749207, -0.09173584, -0.12426758, -0.02632141, 0.08349609, 0.06304932, -0.07244873, -0.05908203, -0.02073669, 0.10937500, -0.07434082, -0.05877686, 0.03421021, 0.06542969, 0.11047363, 0.03811646, -0.06799316, -0.07507324, 0.05410767, -0.06677246, -0.07116699, -0.00974274, -0.04858398, 0.03756714, 0.08044434, -0.07275391, 0.07159424, -0.04287720, 0.04220581, -0.08776855, -0.06573486, -0.09820557, -0.06335449, 0.00559235, -0.06927490, -0.02874756, 0.06311035, -0.05908203, -0.02790833, 0.10058594, -0.02963257, 0.10003662, 0.04251099, -0.10815430, -0.02679443, -0.09503174, -0.07373047, -0.06878662, 0.05255127, 0.04962158, 0.12072754, -0.04849243, 0.11920166, -0.10400391, 0.06945801, 0.07025146, -0.02485657, 0.12243652, 0.02719116, 0.02502441, 0.12231445, 0.10943604, -0.03283691, -0.00690460, 0.00391006, 0.07739258, 0.12322998, -0.12548828, -0.10351562, 0.03503418, -0.00609970, 0.03826904, 0.10174561, 0.03295898, 0.02786255, 0.11206055, 0.00545502, -0.04052734, -0.11035156, -0.02554321, -0.12280273, 0.12243652, -0.00725937, -0.02137756, -0.11578369, -0.01148224, 0.06744385, -0.01660156, 0.01352692, 0.03640747, -0.04562378, -0.09631348, 0.03741455, -0.10034180, 0.07995605, -0.00242424, -0.09942627, -0.02626038, -0.03128052, 0.05093384, -0.12634277, 0.07745361, 0.03948975, 0.02348328, 0.09967041, -0.05886841, -0.02203369, -0.09771729, -0.03500366, -0.10711670, 0.03689575, 0.12646484, -0.09161377, 0.06213379, 0.06567383, 0.04171753, -0.02389526, -0.11035156, 0.08447266, -0.09082031, -0.11828613, -0.11102295, -0.07519531, -0.07897949, 0.12475586, -0.05523682, 0.08752441, 0.11138916, -0.02958679, -0.09222412, 0.09967041, 0.05001831, 0.00957489, 0.07019043, -0.02725220, -0.10394287, 0.12475586, 0.04046631, -0.08575439, -0.04144287, 0.09594727, 0.06671143, -0.09912109, 0.11682129, 0.11560059, 0.05792236, 0.11968994, -0.04351807, 0.00784302, 0.05770874, 0.10461426, 0.04736328, -0.02775574, -0.02455139, -0.05783081, 0.08142090, 0.01890564, -0.01195526, 0.01814270, 0.11022949, -0.02607727, 0.10968018, 0.02185059, -0.03216553, -0.12561035, -0.08111572, 0.12548828, 0.10748291, 0.09277344, -0.09039307, -0.02496338, 0.09197998, -0.10308838, 0.01337433, -0.09991455, -0.05792236, 0.00682068, 0.03820801, -0.01947021, -0.03041077, -0.06964111, 0.07812500, 0.07427979, 0.05865479, -0.08416748, -0.12292480, -0.10144043, -0.09704590, 0.08782959, 0.09320068, -0.03179932, -0.05099487, -0.08947754, 0.11907959, -0.05062866, 0.03381348, 0.03836060, 0.09844971, -0.03485107, -0.02961731, -0.03567505, 0.10656738, -0.07098389, -0.03662109, 0.06634521, -0.08551025, -0.08374023, 0.04855347, -0.04931641, -0.12622070, -0.00310707, 0.04504395, -0.04418945, -0.02706909, -0.10998535, 0.11413574, 0.10314941, 0.10052490, -0.08038330, 0.04223633, -0.11187744, -0.07250977, -0.05001831, 0.04617310, -0.11993408, 0.04922485, -0.05435181, -0.00819397, 0.06469727, -0.05627441, -0.04418945, -0.11730957, -0.05453491, 0.12377930, -0.06927490, -0.04678345, 0.10485840, -0.02653503, 0.07299805, -0.12225342, -0.10827637, 0.07507324, 0.09912109, -0.04568481, -0.06155396, 0.01166534, 0.12164307, -0.05020142, -0.12121582, 0.11444092, 0.00410843, 0.04409790, 0.02166748, 0.07751465, 0.06811523, 0.08825684, 0.00834656, -0.04290771, 0.09765625, -0.11151123, -0.01704407, 0.10314941, -0.06347656, -0.02987671, -0.02128601, -0.01974487, 0.00285721, 0.06555176, -0.12310791, -0.12329102, 0.08764648, -0.05514526, -0.10321045, -0.08831787, 0.05041504, -0.01452637, 0.04638672, -0.00796509, 0.11840820, 0.08361816, -0.04412842, -0.10083008, 0.09649658, 0.02615356, -0.09759521, -0.03192139, 0.11505127, -0.10784912, -0.12841797, 0.08282471, -0.04809570, 0.10937500, 0.07189941, -0.08642578, -0.11968994, -0.04760742, 0.09735107, -0.11621094, 0.12768555, 0.02549744, 0.08398438, 0.01451111, -0.07830811, 0.10589600, 0.01693726, 0.00384140, -0.03784180, 0.06011963, -0.07781982, 0.04510498, -0.08013916, -0.04699707, -0.08428955, 0.12854004, 0.00157642, -0.04983521, -0.11138916, 0.07690430, 0.01759338, 0.08312988, -0.11346436, 0.07415771, 0.09082031, 0.10778809, -0.09417725, 0.04440308, 0.03366089, 0.06198120, -0.00141239, -0.09344482, 0.07830811, 0.07550049, 0.03616333, -0.00443649, 0.06414795, -0.06781006, 0.04156494, 0.09228516, 0.03308105, 0.10650635, -0.06677246, 0.11114502, 0.07318115, -0.08929443, 0.11303711, -0.10357666, 0.09094238, -0.10461426, -0.00096273, -0.02859497, 0.08184814, 0.08306885, -0.05764771, -0.04647827, 0.11444092, 0.00856781, 0.08038330, -0.03030396, -0.11309814, 0.06329346, -0.00131416, 0.05319214, 0.01438141, -0.12200928, 0.05477905, 0.01455688, -0.05187988, 0.10394287, 0.09753418, 0.07519531, 0.01979065, -0.12042236, -0.08489990, -0.06958008, 0.10778809, -0.12432861, -0.09082031, -0.11755371, 0.02627563, 0.02201843, 0.09429932, 0.06335449, -0.04287720, 0.06457520, 0.12298584, -0.04797363, 0.03222656, -0.04095459, 0.00543213, 0.09863281, 0.02458191, -0.07409668, -0.06701660, 0.08892822, -0.03607178, -0.09661865, 0.07598877, 0.12670898, -0.10852051, 0.02909851, -0.08374023, -0.11035156, 0.05532837, 0.00281334, -0.07434082, -0.12817383, -0.07470703, 0.10827637, 0.04046631, -0.12017822, 0.10540771, -0.00059891, -0.09362793, -0.00499344, -0.04803467, 0.03671265, 0.01667786, -0.00600052, 0.05615234, 0.00335693, 0.11669922, 0.12780762, -0.06744385, 0.09265137, 0.05984497, 0.08447266, 0.08166504, 0.09082031, 0.02110291, -0.12463379, 0.12646484, 0.10034180, -0.05587769, 0.12878418, 0.02368164, -0.10852051, -0.11724854, 0.02442932, -0.06921387, 0.02313232, 0.06396484, -0.00501633, 0.11157227, 0.09783936, 0.01453400, 0.05688477, -0.12243652, -0.01343536, -0.07379150, -0.04016113, -0.12561035, -0.01980591, 0.01428223, -0.12890625, 0.07385254, 0.02120972, 0.03729248, -0.05099487, 0.08563232, -0.07904053, -0.09509277, -0.09143066, 0.10052490, 0.06896973, 0.09735107, 0.10668945, -0.01683044, 0.09356689, -0.00362396, -0.04598999, 0.00282288, 0.09954834, -0.11798096, -0.00731659, 0.01055145, 0.00230980, -0.03079224, -0.04052734, 0.00307846, 0.02340698, -0.10113525, -0.01992798, 0.00364304, -0.09539795, 0.03053284, 0.06500244, 0.04736328, -0.10937500, -0.00327301, 0.10107422, 0.09692383, -0.00841522, -0.04977417, 0.12133789, -0.06805420, 0.11566162, 0.02381897, 0.00247192, 0.12292480, 0.08300781, -0.10845947, 0.05786133, 0.01922607, 0.11968994, 0.11773682, 0.03427124, -0.00772095, 0.01377869, -0.06756592, -0.09167480, 0.08911133, 0.09576416, 0.02049255, -0.12292480, -0.00814819, 0.06207275, 0.09436035, 0.01638794, 0.01360321, 0.11773682, 0.03973389, -0.08813477, -0.10675049, 0.05932617, -0.02507019, -0.11560059, -0.11114502, -0.10858154, -0.10107422, 0.05288696, 0.08843994, 0.03994751, -0.00619125, 0.06811523, 0.06591797, -0.05493164, -0.09918213, -0.12585449, 0.02449036, 0.00563812, 0.02311707, 0.05426025, -0.06774902, 0.06909180, 0.11041260, 0.03161621, -0.02879333, -0.01333618, -0.07226562, 0.09051514, 0.05325317, -0.06713867, -0.07812500, 0.08392334, 0.04586792, -0.06921387, -0.06921387, 0.03022766, 0.09844971, -0.01124573, 0.09594727, 0.10107422, 0.06835938, -0.01692200, -0.05691528, 0.01972961, -0.00037789, 0.06262207, -0.07958984, 0.00324249, -0.09991455, 0.08093262, -0.04397583, 0.08892822, 0.02157593, -0.01597595, -0.07916260, -0.00277519, 0.11212158, -0.08831787, -0.00965118, -0.06768799, -0.04800415, -0.00428391, 0.00619507, -0.02021790, -0.08666992, -0.12207031, 0.08532715, -0.01507568, 0.04672241, -0.02981567, 0.09027100, -0.09277344, -0.01737976, -0.06811523, 0.05508423, 0.07739258, 0.08428955, 0.06658936, -0.08758545, -0.05532837, -0.00159740, 0.08569336, 0.11608887, -0.02987671, -0.06402588, -0.05484009, 0.11981201, -0.12902832, -0.07147217, 0.08355713, -0.03302002, -0.00121403, 0.08978271, -0.12622070, -0.05352783, 0.08233643, -0.11590576, -0.07128906, 0.00046039, -0.04251099, -0.01606750, 0.01480103, 0.12731934, -0.05862427, -0.11022949, 0.07702637, -0.07696533, 0.12097168, 0.06268311, -0.11645508, 0.08331299, 0.10333252, 0.11273193, -0.01942444, 0.03469849, 0.02035522, -0.01811218, 0.10321045, 0.01759338, -0.01071167, 0.09625244, -0.03839111, -0.11676025, -0.00769043, 0.06835938, -0.00978851, -0.05624390, -0.10357666, 0.04791260, -0.05731201, 0.05902100, -0.04614258, -0.02127075, -0.05706787, -0.11895752, 0.00900269, -0.04510498, -0.02102661, 0.02593994, -0.10198975, 0.00649643, 0.11657715, 0.09228516, 0.08905029, 0.01840210, 0.09210205, 0.04608154, 0.04949951, -0.02612305, 0.05422974, 0.12011719, -0.02822876, -0.06683350, -0.03155518, 0.10540771, 0.09069824, 0.05493164, 0.04534912, 0.10394287, -0.02949524, -0.05984497, 0.10638428, -0.02050781, 0.05773926, -0.01416779, 0.00077915, -0.04830933, 0.03390503, 0.01602173, -0.09094238, 0.12683105, 0.06896973, 0.08215332, -0.01368713, 0.00627518, -0.06231689, 0.08081055, -0.05941772, -0.08953857, -0.09594727, -0.08593750, 0.08587646, -0.09515381, 0.10864258, 0.11920166, 0.05001831, 0.01579285, 0.03060913, 0.08905029, -0.12158203, 0.03256226, -0.06591797, 0.06082153, 0.02726746, 0.02340698, 0.05996704, 0.08959961, 0.10302734, -0.04464722, -0.12109375, 0.09558105, -0.12188721, 0.05911255, 0.08264160, 0.01971436, -0.09399414, -0.06045532, -0.00405884, -0.01525879, 0.11645508, -0.11358643, -0.07855225, 0.00896454, 0.02563477, 0.03674316, 0.08190918, 0.12176514, -0.06106567, -0.08288574, -0.06903076, -0.03408813, -0.04266357, -0.08398438, 0.01795959, 0.06286621, -0.07836914, 0.03646851, 0.03063965, -0.01541138, -0.03652954, 0.02951050, 0.07470703, 0.11328125, -0.08398438, 0.08868408, -0.02059937, 0.11376953, -0.12646484, -0.02861023, 0.10870361, 0.09582520, 0.07513428, 0.11346436, -0.08178711, -0.02429199, 0.00878143, -0.03820801, -0.05010986, -0.01030731, -0.04129028, -0.01817322, -0.03201294, -0.08935547, 0.01841736, 0.08129883, -0.07293701, 0.05145264, -0.05484009, -0.09436035, -0.09020996, -0.11834717, -0.08752441, -0.07360840, 0.03906250, -0.11035156, 0.00548935, -0.02348328, 0.02101135, -0.09094238, -0.08642578, 0.03601074, -0.08813477, 0.02098083, -0.04916382, -0.00687790, 0.04690552, 0.08074951, 0.05206299, -0.05334473, 0.02352905, -0.08514404, -0.01875305, 0.03671265, -0.06072998, 0.06927490, -0.04776001, -0.09893799, 0.03631592, -0.04724121, -0.04376221, -0.06658936, 0.07940674, -0.01896667, -0.10815430, 0.02996826, 0.00425339, 0.07342529, 0.05895996, 0.09252930, 0.04028320, 0.11627197, -0.07293701, 0.11737061, 0.04910278, 0.12585449, 0.01078796, 0.03189087, 0.09112549, 0.11297607, -0.11291504, -0.09808350, -0.12792969, -0.01855469, 0.08325195, -0.03344727, 0.01220703, -0.04785156, 0.06317139, 0.07513428, 0.08197021, 0.10968018, -0.02493286, 0.05456543, 0.11749268, -0.06076050, -0.02101135, 0.11108398, -0.07482910, 0.11590576, -0.07263184, 0.09063721, -0.02590942, 0.01910400, 0.10424805, -0.04272461, -0.00155544, 0.00326157, -0.12780762, 0.02127075, 0.12475586, 0.00314331, -0.07232666, 0.00281143, -0.12152100, 0.01954651, -0.10980225, -0.10028076, 0.01432800, -0.06787109, 0.12091064, 0.08459473, 0.03007507, -0.07440186, -0.05484009, 0.05682373, -0.04971313, -0.11236572, -0.10498047, -0.08831787, 0.02912903, -0.04562378, -0.04534912, 0.00399780, 0.06744385, 0.07574463, 0.01110840, 0.05169678, -0.04187012, -0.10162354, 0.09002686, 0.11999512, 0.07031250, 0.11907959, -0.06008911, 0.10595703, 0.07867432, 0.01409149, -0.05303955, 0.01799011, 0.04022217, 0.00010526, 0.11840820, 0.06262207, -0.04727173, -0.10504150, 0.09887695, 0.08325195, 0.00656509, 0.12597656, 0.06445312, 0.01872253, -0.10467529, -0.05023193, -0.07586670, 0.01895142, -0.00901794, -0.02331543, -0.07025146, -0.05499268, -0.09155273, -0.12646484, 0.02790833, -0.05032349, -0.09820557, 0.03530884, -0.11840820, 0.03442383, 0.10961914, -0.00051594, -0.12792969, -0.03900146, -0.05883789, -0.00759888, -0.00430298, -0.11083984, 0.06433105, -0.07843018, 0.03924561, 0.12152100, 0.12274170, -0.06927490, -0.05670166, -0.01779175, 0.05358887, 0.12432861, -0.07739258, -0.09008789, -0.01045227, 0.06118774, -0.01206970, -0.08685303, -0.12139893, 0.06045532, 0.09619141, 0.11315918, 0.12384033, -0.08599854, 0.06118774, 0.04928589, -0.07879639, 0.07189941, 0.08465576, -0.03091431, 0.11901855, -0.06445312, -0.04727173, 0.02622986, -0.02453613, 0.09570312, 0.08386230, 0.00300789, -0.00319672, 0.06134033, -0.11254883, -0.01564026, 0.08612061, 0.09783936, 0.02745056, -0.01300812, 0.04165649, 0.02621460, -0.06280518, 0.02903748, -0.05761719, 0.02389526, -0.12902832, 0.08013916, -0.09490967, 0.01206207, 0.04483032, 0.05798340, 0.00566864, 0.10052490, -0.10595703, 0.07122803, -0.04446411, 0.01505280, -0.08703613, -0.03024292, 0.08673096, -0.11914062, 0.10778809, 0.01686096, -0.07843018, -0.08172607, 0.01226044, -0.08966064, -0.03955078, 0.01921082, 0.08489990, 0.08538818, -0.01840210, 0.02755737, 0.07635498, 0.01219177, 0.06213379, 0.09887695, -0.07873535, 0.00266838, -0.00153542, -0.00237656, 0.08508301, 0.11328125, -0.04721069, -0.06243896, -0.00700378, -0.09118652, -0.01898193, 0.12573242, -0.08227539, -0.07995605, 0.06082153, 0.12139893, 0.03970337, -0.07629395, 0.07836914, -0.09649658, 0.05337524, 0.06671143, 0.12902832, -0.01995850, 0.00843048, -0.03588867, -0.02984619, -0.08435059, -0.06481934, -0.03594971, -0.05020142, -0.06170654, 0.00553894, -0.03134155, 0.02043152, 0.01303864, -0.05459595, -0.04080200, 0.12280273, 0.01768494, -0.02494812, -0.09155273, 0.11840820, 0.10534668, -0.02642822, 0.02482605, -0.07025146, 0.02401733, -0.06640625, 0.06219482, 0.08465576, -0.09497070, 0.06756592, -0.03884888, 0.10540771, 0.06188965, -0.01947021, 0.12683105, -0.01800537, 0.02947998, 0.03152466, -0.02824402, -0.07708740, 0.05767822, -0.00195885, 0.03488159, -0.04635620, 0.02273560, -0.05917358, -0.09643555, 0.00051069, -0.01968384, 0.01850891, -0.10015869, -0.07934570, 0.11126709, -0.00219536, 0.02841187, 0.11706543, 0.11779785, -0.02770996, -0.04861450, -0.03128052, 0.10186768, -0.03942871, -0.06143188, 0.04797363, 0.09844971, 0.12188721, 0.01968384, 0.11004639, -0.01805115, 0.11694336, -0.02694702, -0.04193115, -0.07611084, -0.07745361, 0.07360840, 0.03359985, -0.12390137, -0.02815247, 0.08563232, -0.08093262, 0.09338379, 0.10345459, -0.05603027, 0.01722717, 0.10864258, -0.09088135, 0.07110596, -0.10302734, 0.08398438, 0.01707458, 0.06701660, 0.04626465, 0.06982422, -0.06909180, -0.06909180, 0.02238464, 0.06988525, 0.03143311, 0.02947998, 0.05264282, 0.02836609, 0.05468750, -0.05422974, -0.05807495, -0.02365112, 0.00463867, 0.04263306, 0.12609863, -0.02551270, -0.07214355, 0.11334229, 0.10992432, -0.10357666, 0.10522461, -0.01390076, 0.11676025, 0.00650406, 0.03640747, -0.12805176, -0.08166504, 0.08416748, -0.01885986, 0.04571533, 0.09893799, -0.04013062, -0.08142090, 0.00851440, 0.01622009, 0.12500000, 0.09185791, 0.00287056, 0.12176514, 0.06750488, 0.03060913, 0.00472260, 0.09051514, -0.09490967, 0.03546143, 0.09222412, -0.02346802, 0.11364746, -0.02529907, -0.03320312, -0.12658691, 0.04397583, 0.07336426, -0.01032257, -0.05227661, -0.03024292, 0.06518555, 0.01324463, 0.04489136, -0.08612061, -0.04974365, -0.07043457, 0.02305603, -0.12048340, 0.08453369, -0.02558899, 0.03497314, 0.04922485, 0.05981445, 0.08837891, -0.03543091, -0.03793335, -0.00539398, -0.02990723, 0.09912109, -0.12054443, 0.02987671, 0.01603699, -0.01853943, 0.06420898, -0.07574463, -0.09216309, -0.04409790, 0.06646729};
// Biases for layer: fc1 @32;
float fc1_bias_transposed[32] = {0.09790039, 0.09429932, 0.08624268, 0.02108765, 0.08538818, -0.06234741, 0.09832764, 0.06143188, -0.07183838, 0.01910400, -0.04574585, -0.08782959, -0.06188965, 0.05612183, -0.00368500, 0.11828613, -0.07275391, 0.09606934, 0.11303711, 0.07348633, -0.12298584, -0.04034424, 0.01510620, -0.02165222, -0.03787231, 0.04046631, -0.10412598, -0.10015869, -0.12731934, -0.06359863, -0.00258827, -0.08673096};

// ================== Relu: relu ================== //
// Relu for layer: relu;

// ================== Layer: fc2 ================== //
// Transposed weights for layer: fc2 @32x5;
float fc2_weight_transposed[160] = {-0.03982544, -0.14965820, -0.09454346, -0.03607178, -0.06018066, 0.03869629, -0.08410645, -0.01454163, -0.13806152, -0.05816650, 0.16943359, 0.03366089, 0.05978394, -0.04571533, 0.02496338, -0.10571289, 0.12463379, -0.00029087, -0.11083984, 0.03018188, -0.01924133, -0.12951660, -0.01635742, -0.02703857, -0.12768555, -0.13037109, -0.08856201, -0.11737061, -0.15112305, -0.14721680, -0.08850098, -0.04196167, 0.12078857, -0.02517700, 0.07458496, 0.06494141, 0.02078247, -0.15075684, -0.03848267, 0.06799316, 0.00310135, 0.09521484, -0.02105713, -0.07318115, 0.11816406, -0.12963867, 0.10333252, -0.07098389, 0.07965088, -0.03192139, 0.16931152, 0.15222168, 0.07391357, -0.07647705, 0.00066662, -0.04763794, -0.03231812, -0.02430725, 0.03738403, 0.03790283, -0.07476807, 0.00263023, -0.15649414, 0.03900146, -0.07598877, -0.17138672, -0.01252747, -0.12463379, 0.09631348, 0.09893799, 0.09033203, 0.11798096, -0.12561035, 0.14404297, -0.08837891, 0.12011719, -0.17431641, 0.17419434, 0.11169434, -0.06530762, 0.06707764, 0.06198120, -0.04934692, 0.06015015, 0.08599854, -0.12500000, -0.02963257, 0.12060547, 0.00247574, 0.02029419, -0.01544952, 0.03436279, 0.15393066, 0.13732910, -0.08880615, -0.00116634, -0.01969910, 0.13354492, -0.11553955, -0.12841797, -0.04306030, -0.10473633, 0.15454102, 0.03013611, 0.06561279, 0.07598877, 0.05368042, 0.04739380, -0.12457275, 0.12646484, 0.10113525, 0.06768799, 0.02604675, -0.15563965, 0.07611084, -0.05523682, -0.02691650, -0.16491699, 0.12347412, 0.12512207, 0.02960205, -0.16223145, 0.04760742, 0.16894531, 0.16259766, 0.15319824, 0.11053467, -0.13720703, 0.05941772, -0.07427979, 0.07708740, 0.12371826, -0.08752441, -0.08258057, 0.07849121, -0.14965820, -0.08489990, -0.12054443, 0.16870117, -0.12573242, -0.00630569, -0.00493622, -0.13708496, -0.15393066, -0.16149902, -0.02976990, -0.13647461, 0.15051270, 0.16735840, 0.08972168, 0.04263306, 0.17553711, -0.16625977, 0.08337402, -0.11535645, 0.07812500, -0.04730225, -0.10559082, 0.08111572, -0.09997559};
// Biases for layer: fc2 @5;
float fc2_bias_transposed[5] = {-0.02864075, -0.02499390, 0.09075928, -0.02339172, 0.00730515};

// ================== SoftMax: softmax ================== //
// SoftMax for layer: softmax;

// Conv1d 实现
float *Conv1d(int batch_size, int in_channels, int sequence_length, float *input, int out_channels, int kernel_size, int stride, int padding, float *weights, float *bias, bool use_bias)
{
    int output_length = sequence_length - kernel_size + 1;
    float *output_array = (float *)malloc(batch_size * out_channels * output_length * sizeof(float));

    // 手动计算卷积
    for (int n = 0; n < batch_size; ++n)
    { // 批次
        for (int c_out = 0; c_out < out_channels; ++c_out)
        { // 输出通道
            for (int i = 0; i < output_length; ++i)
            { // 输出序列长度
                float conv_sum = 0.0f;
                for (int c_in = 0; c_in < in_channels; ++c_in)
                { // 输入通道
                    int start_idx = c_out * in_channels * kernel_size + c_in * kernel_size;
                    for (int k = 0; k < kernel_size; ++k)
                    {
                        int input_idx = n * in_channels * sequence_length + c_in * sequence_length + (i + k);
                        int weight_idx = start_idx + k;
                        conv_sum += input[input_idx] * weights[weight_idx];
                    }
                }
                int output_idx = n * out_channels * output_length + c_out * output_length + i;
                output_array[output_idx] = conv_sum;

                // 添加偏置项
                if (use_bias)
                {
                    output_array[output_idx] += bias[c_out];
                }
            }
        }
    }

    return output_array;
}
float *Linear(int batch_size, int input_size, int output_size, float *input, float *weight_transposed, float *bias)
{
    int i, j, k;

    // 为结果矩阵分配内存
    float *result = (float *)malloc(batch_size * output_size * sizeof(float));
    if (result == NULL)
    {
        printf("Error: Memory allocation failed.\n");
        return NULL;
    }

    // 初始化并执行矩阵乘法
    for (i = 0; i < batch_size; i++)
    {
        for (j = 0; j < output_size; j++)
        {
            result[i * output_size + j] = 0; // 初始化元素为0
            for (k = 0; k < input_size; k++)
            {
                result[i * output_size + j] += input[i * input_size + k] * weight_transposed[k * output_size + j];
            }
            result[i * output_size + j] += bias[j]; // 将偏置项加到结果中
        }
    }

    // 返回结果矩阵
    return result;
}
void Relu(int batch_size, int elements_length, float *input)
{
    for (int i = 0; i < batch_size * elements_length; i++)
    {
        if (input[i] < 0)
        {
            input[i] = 0;
        }
    }
}
void SoftMax(int batch_size, int elements_length, float *input)
{
    float max_value, sum_exp;

    // 逐行计算softmax
    for (int i = 0; i < batch_size; i++)
    {
        // 找到该行的最大值
        max_value = input[i * elements_length];
        for (int j = 1; j < elements_length; j++)
        {
            if (input[i * elements_length + j] > max_value)
            {
                max_value = input[i * elements_length + j];
            }
        }

        // 计算该行的指数和
        sum_exp = 0.0f;
        for (int j = 0; j < elements_length; j++)
        {
            input[i * elements_length + j] = exp(input[i * elements_length + j] - max_value);
            sum_exp += input[i * elements_length + j];
        }

        // 归一化得到softmax输出
        for (int j = 0; j < elements_length; j++)
        {
            input[i * elements_length + j] /= sum_exp;
        }
    }
}

float* forward(float input[], float output[]){
	float* result_0=(float*)malloc(sizeof(float)*30);
for (int i = 0; i < 30; i++) { result_0[i] = input[i]; }
// conv1d_1_layer
// conv1d_1_layer(batch_size: 1, in_channels: 3, sequence_length: 10)
// => @(batch_size: 1, out_channels: 5, out_sequence_length: 8)
float* result_1 = Conv1d(1,3,10, result_0, 5, 3, 1, 0, conv1d_1_weights, conv1d_1_bias, true);
free(result_0);
// conv1d_2_layer
// conv1d_2_layer(batch_size: 1, in_channels: 5, sequence_length: 8)
// => @(batch_size: 1, out_channels: 10, out_sequence_length: 6)
float* result_2 = Conv1d(1,5,8, result_1, 10, 3, 1, 0, conv1d_2_weights, conv1d_2_bias, true);
free(result_1);
// fl1_layer
// fc1_layer
float* result_3 = Linear(1,60,32,result_2,fc1_weight_transposed,fc1_bias_transposed);
free(result_2);
// relu_relu
Relu(1,32,result_3);
// fc2_layer
float* result_4 = Linear(1,32,5,result_3,fc2_weight_transposed,fc2_bias_transposed);
free(result_3);
// softmax_layer
SoftMax(1,5,result_4);
for (int i = 0; i < 5; i++) { output[i] = result_4[i]; }
	free(result_4);
}
int main(){
float input[30] = { 0.2558668553829193,0.5198169350624084,0.11187387257814407,0.6237596869468689,-0.09302826970815659,-1.9301820993423462,0.3131643831729889,1.2675502300262451,1.4183008670806885,-0.13377965986728668,1.4947007894515991,-0.2707495093345642,0.7566108703613281,0.768798291683197,-1.0390127897262573,-0.41506627202033997,0.5046725273132324,-0.4002172648906708,0.40265920758247375,1.8980133533477783,0.5580689311027527,-0.026996269822120667,1.0788123607635498,-0.9705650806427002,0.4978352189064026,0.6404419541358948,-0.8619866967201233,-0.033859118819236755,0.2017722725868225,-1.1262553930282593 };
float output[5];
forward(input, output);
for (int i = 0; i < 5; i++){ printf("%f  ", output[i]); 
 }
return 0;
}